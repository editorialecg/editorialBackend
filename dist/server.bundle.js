(()=>{"use strict";var e={706:(e,r,n)=>{n.r(r),n.d(r,{findOneUser:()=>o,findByEmail:()=>p,createUser:()=>l,confirmEmail:()=>m,changePassword:()=>h,changeName:()=>y,changelastName:()=>x,changeUsername:()=>k,changeEmail:()=>U,updateUser:()=>q,updateEbookFront:()=>O});var t=n(373),u=n.n(t),a=n(531),i=n.n(a),s=n(590);function o(e){return c.apply(this,arguments)}function c(){return(c=u()(i().mark((function e(r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){return s.Z.findOne({username:r},(function(r,t){if(r)return n(r);e(t)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return f.apply(this,arguments)}function f(){return(f=u()(i().mark((function e(r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){return s.Z.findOne({email:r},(function(r,t){if(r)return n(r);e(t)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e,r,n,t,u,a,i,s,o,c,p){return d.apply(this,arguments)}function d(){return(d=u()(i().mark((function e(r,n,t,u,a,o,c,p,f,l,d){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){return s.Z.create({name:r,lastname:n,email:t,verifyEmail:u,codeVerify:a,username:o,password:c,country:p,birthDay:f,birthMonth:l,birthYear:d},(function(r,n){if(r)return i(r);e(n)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,r){return g.apply(this,arguments)}function g(){return(g=u()(i().mark((function e(r,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){return s.Z.findOneAndUpdate({username:r},{verifyEmail:n},{new:!0},(function(r,n){if(r)return t(r);e(n)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e,r){return b.apply(this,arguments)}function b(){return(b=u()(i().mark((function e(r,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){return s.Z.findOneAndUpdate({username:r},{password:n},{new:!0},(function(r,n){if(r)return t(r);e(n)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e,r){return w.apply(this,arguments)}function w(){return(w=u()(i().mark((function e(r,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){return s.Z.findOneAndUpdate({username:r},{name:n},{new:!0},(function(r,n){if(r)return t(r);e(n)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e,r){return S.apply(this,arguments)}function S(){return(S=u()(i().mark((function e(r,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){return s.Z.findOneAndUpdate({username:r},{lastname:n},{new:!0},(function(r,n){if(r)return t(r);e(n)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,r){return v.apply(this,arguments)}function v(){return(v=u()(i().mark((function e(r,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){return s.Z.findOneAndUpdate({username:r},{username:n},{new:!0},(function(r,n){if(r)return t(r);e(n)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,r){return E.apply(this,arguments)}function E(){return(E=u()(i().mark((function e(r,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){return s.Z.findOneAndUpdate({username:r},{email:n},{new:!0},(function(r,n){if(r)return t(r);e(n)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,r){return P.apply(this,arguments)}function P(){return(P=u()(i().mark((function e(r,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){return s.Z.findOneAndUpdate({username:r},n,{new:!0},(function(r,n){if(r)return t(r);e(n)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e,r){return B.apply(this,arguments)}function B(){return(B=u()(i().mark((function e(r,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){return s.Z.findOneAndUpdate({username:r},n,{new:!0},(function(r,n){if(r)return t(r);e(n)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},55:(e,r,n)=>{var t=n(373),u=n.n(t),a=n(531),i=n.n(a);e=n.hmd(e);var s=n(706);e.exports={findOneUser:function(e){return u()(i().mark((function r(){return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.findOneUser(e);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})))()},findByEmail:function(e){return u()(i().mark((function r(){return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.findByEmail(e);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})))()},createUser:function(e,r,n,t,a,o,c,p,f,l,d){return u()(i().mark((function u(){return i().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,s.createUser(e,r,n,t,a,o,c,p,f,l,d);case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}}),u)})))()},confirmEmail:function(e,r){return u()(i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.confirmEmail(e,r);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},changePassword:function(e,r){return u()(i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.changePassword(e,r);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},changeName:function(e,r){return u()(i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.changeName(e,r);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},changelastName:function(e,r){return u()(i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.changelastName(e,r);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},changeEmail:function(e,r){return u()(i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.changeEmail(e,r);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},changeUsername:function(e,r){return u()(i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.changeUsername(e,r);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},updateUser:function(e,r){return u()(i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.updateUser(e,r);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},updateEbookFront:function(e,r){return u()(i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.updateEbookFront(e,r);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()}}},201:(e,r,n)=>{n.r(r),n.d(r,{default:()=>t});const t=(0,n(619).connect)("mongodb+srv://".concat(process.env.MONGODB_USER,":").concat(process.env.MONGODB_PASSWORD,"@cluster0.nkdgo.mongodb.net/").concat(process.env.MONGODB_DB,"?retryWrites=true&w=majority"),{useNewUrlParser:!0,useUnifiedTopology:!0,useFindAndModify:!1,useCreateIndex:!0}).then((function(){return console.log("DataBase Connected")}),(function(e){return console.log("DataBase Error ",e)}))},590:(e,r,n)=>{n.d(r,{Z:()=>i});var t=n(619),u={timestamps:{currentTime:function(){return Math.floor(Date.now())}}},a=(0,t.Schema)({name:{type:String,require:!0,default:""},lastname:{type:String,require:!0,default:""},email:{type:String,require:!0,default:""},verifyEmail:{type:Boolean},codeVerify:{type:String,default:""},username:{type:String,require:!0,default:""},password:{type:String,require:!0,default:""},country:{type:String,require:!0,default:""},birthDay:{type:String,require:!0,default:""},birthMonth:{type:String,require:!0,default:""},birthYear:{type:String,require:!0,default:""},ebookAccess:{type:Array,default:[]}},u);const i=(0,t.model)("signin",a)},373:e=>{e.exports=require("@babel/runtime/helpers/asyncToGenerator")},531:e=>{e.exports=require("@babel/runtime/regenerator")},334:e=>{e.exports=require("dotenv")},619:e=>{e.exports=require("mongoose")}},r={};function n(t){var u=r[t];if(void 0!==u)return u.exports;var a=r[t]={id:t,loaded:!1,exports:{}};return e[t](a,a.exports,n),a.loaded=!0,a.exports}n.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return n.d(r,{a:r}),r},n.d=(e,r)=>{for(var t in r)n.o(r,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=require("express");var r=n.n(e);const t=require("morgan");var u=n.n(t);const a=require("cors");var i=n.n(a);const s=require("compression");var o=n.n(s);const c=require("helmet");var p=n.n(c);const f=require("express-graphql"),l=(0,require("graphql").buildSchema)("\n\n    type Query{\n        oneUser(username: String!): User!\n        oneEbook(title: String!): Ebook!\n        oneEbookPages(username: String! title: String!): Ebook!\n        allEbook: [Ebook!]!\n        myEbooks(username: String!): User!\n    }\n\n    type Mutation{\n        login(username: String! password: String!): User!\n        createUser(name: String! lastname: String! email: String! username: String! password: String! country: String! birthDay: String! birthMonth: String! birthYear: String!): User!\n        \n        confirmCode(username: String! code: String!): User!\n        confirmPassword(username: String! password: String!): User!\n        confirmUser(username: String!): User!\n\n        changePassword(username: String! password: String!): User!\n        updateUser(\n            oldUsername: String! newUsername: String name: String lastname: String email: String\n        ): User\n\n\n        createEbook(\n            title: String! subTitle: String path: String! content: [String!] pages: String! published: String!\n            language: String! author: String! authorBio: String copyReader: String!\n            copyReaderBio: String illustrator: String! \n            illustratorBio: String edition: String! gender: String!\n            description: String! btnPayPal: String! legalDepo: String!\n            isbn: String! editor: String! editorBio: String price: String!\n        ): Ebook!\n\n\n        ebookPayed(username: String! title: String!): User!\n        updateEbookSelled(title: String!): Ebook!\n    }\n\n    type Ebook{\n        title: String!\n        subTitle: String\n        path: String!\n        pages: String!\n        content: [String]\n        published: String!\n        language: String!\n        author: String!\n        authorBio: String!\n        copyReader: String!\n        copyReaderBio: String!\n        illustrator: String!\n        illustratorBio: String!\n        editor: String!\n        editorBio: String!\n        edition: String!\n        gender: String!\n        description: String!\n        btnPayPal: String!\n        legalDepo: String!\n        isbn: String!\n        price: String!\n        selled: String\n    }\n\n    type User{\n        name: String!\n        lastname: String!\n        email: String!\n        verifyEmail: Boolean!\n        codeVerify: String!\n        username: String!\n        country: String!\n        birthDay: String!\n        birthMonth: String!\n        birthYear: String!\n        ebookAccess: [String]\n        \n    }\n\n    \n\n");var d=n(373),m=n.n(d),g=n(531),h=n.n(g),b=n(55),y=n(619),w={timestamps:{currentTime:function(){return Math.floor(Date.now())}}},x=(0,y.Schema)({title:{type:String,require:!0},subTitle:{type:String},path:{type:String,require:!0},pages:{type:String,require:!0},content:{type:[String]},published:{type:String,require:!0},language:{type:String,require:!0},author:{type:String,require:!0},authorBio:{type:String,require:!0},copyReader:{type:String,require:!0},copyReaderBio:{type:String,require:!0},illustrator:{type:String,require:!0},illustratorBio:{type:String,require:!0},editor:{type:String,require:!0},editorBio:{type:String,require:!0},edition:{type:String,require:!0},gender:{type:String,require:!0},description:{type:String,require:!0},btnPayPal:{type:String,require:!0},legalDepo:{type:String,require:!0},isbn:{type:String,require:!0},price:{type:String,require:!0},selled:{type:Number,default:0}},w);const S=(0,y.model)("ebookfronts",x);function k(){return v.apply(this,arguments)}function v(){return(v=m()(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){return S.find({},(function(n,t){if(n)return r(n);e(t)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){return E.apply(this,arguments)}function E(){return(E=m()(h().mark((function e(r){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){return S.findOne({title:r},(function(r,t){if(r)return n(r);e(t)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,r){return P.apply(this,arguments)}function P(){return(P=m()(h().mark((function e(r,n){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){return S.findOneAndUpdate({title:r},{selled:n},{new:!0},(function(r,n){if(r)return t(r);e(n)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e,r,n,t,u,a,i,s,o,c,p,f,l,d,m,g,h,b,y,w,x,S){return B.apply(this,arguments)}function B(){return(B=m()(h().mark((function e(r,n,t,u,a,i,s,o,c,p,f,l,d,m,g,b,y,w,x,k,v,U){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,h){return S.create({title:r,subTitle:n,path:t,content:u,pages:a,published:i,language:s,author:o,authorBio:c,copyReader:p,copyReaderBio:f,illustrator:l,illustratorBio:d,edition:m,gender:g,description:b,btnPayPal:y,legalDepo:w,isbn:x,editor:k,editorBio:v,price:U},(function(r,n){if(r)return h(r);e(n)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return A.apply(this,arguments)}function A(){return(A=m()(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return T.apply(this,arguments)}function T(){return(T=m()(h().mark((function e(r){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e,r){return N.apply(this,arguments)}function N(){return(N=m()(h().mark((function e(r,n){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(r,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e,r,n,t,u,a,i,s,o,c,p,f,l,d,m,g,h,b,y,w,x,S){return j.apply(this,arguments)}function j(){return(j=m()(h().mark((function e(r,n,t,u,a,i,s,o,c,p,f,l,d,m,g,b,y,w,x,S,k,v){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(r,n,t,u,a,i,s,o,c,p,f,l,d,m,g,b,y,w,x,S,k,v);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}const I=require("bcrypt"),_=(require("jsonwebtoken"),require("nodemailer"));function V(e,r){return C.apply(this,arguments)}function C(){return(C=m()(h().mark((function e(r,n){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,I.compareSync)(r,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e){return G.apply(this,arguments)}function G(){return(G=m()(h().mark((function e(r){var n,t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,I.genSaltSync)(10),t=(0,I.hashSync)(r,n),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e,r){return Y.apply(this,arguments)}function Y(){return(Y=m()(h().mark((function e(r,n){var t,u;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:process.env.EDITORIALUSER,t=process.env.EDITORIALEMAIL,u=process.env.EDITORIAL_PWD,(0,_.createTransport)({host:"smtp.editorialgrande.com",port:587,secure:!1,requireTLS:!0,tls:{rejectUnauthorized:!1},auth:{user:t,pass:u}}).sendMail({from:"Soporte de Escribe como los Grandes ".concat(t),to:r,subject:"Codigo de verificación",text:"Tu codigo de verificación es: "+n},(function(e,r){if(!e)return r;console.log(e)}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return z.apply(this,arguments)}function z(){return(z=m()(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Math.random().toString(36).substr(2));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}const H={oneUser:(oe=m()(h().mark((function e(r,n,t){var u;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.User,u=r.username){e.next=4;break}return e.abrupt("return",null);case 4:return e.next=6,(0,b.findOneUser)(u);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)}))),function(e,r,n){return oe.apply(this,arguments)}),oneEbook:(se=m()(h().mark((function e(r,n,t){var u,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.Ebook,u=r.title){e.next=4;break}return e.abrupt("return",null);case 4:return e.next=6,M(u);case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)}))),function(e,r,n){return se.apply(this,arguments)}),oneEbookPages:(ie=m()(h().mark((function e(r,n,t){var u,a,i,s,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Ebook,u=r.username,a=r.title,e.next=4,(0,b.findOneUser)(u);case 4:return i=e.sent,e.next=7,M(a);case 7:s=e.sent,o=0;case 9:if(!(o<i.ebookAccess.length)){e.next=16;break}if(i.ebookAccess[o]!=s.title){e.next=13;break}return e.abrupt("return",s);case 13:o++,e.next=9;break;case 16:case"end":return e.stop()}}),e)}))),function(e,r,n){return ie.apply(this,arguments)}),allEbook:(ae=m()(h().mark((function e(r,n,t){var u;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Ebook,e.next=3,D();case 3:return u=e.sent,e.abrupt("return",u);case 5:case"end":return e.stop()}}),e)}))),function(e,r,n){return ae.apply(this,arguments)}),myEbooks:(ue=m()(h().mark((function e(r,n,t){var u,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Ebook,u=r.username,e.next=4,(0,b.findOneUser)(u);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)}))),function(e,r,n){return ue.apply(this,arguments)}),login:(te=m()(h().mark((function e(r,n,t){var u,a,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.User,u=r.username,a=r.password,u&&a){e.next=4;break}throw new Error({code:400,message:"Username or Password empty"});case 4:return e.next=6,(0,b.findOneUser)(u);case 6:if(i=e.sent){e.next=9;break}throw new Error({code:403,message:"User not exist"});case 9:return e.next=11,V(a,i.password);case 11:if(!e.sent){e.next=15;break}return e.abrupt("return",i);case 15:throw new Error({code:401,message:"Unauthorized"});case 16:case"end":return e.stop()}}),e)}))),function(e,r,n){return te.apply(this,arguments)}),createUser:(ne=m()(h().mark((function e(r,n,t){var u,a,i,s,o,c,p,f,l,d,m,g,y,w;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.User,u=r.name,a=r.lastname,i=r.username,s=r.email,o=r.password,c=r.country,p=r.birthDay,f=r.birthMonth,l=r.birthYear,u&&a&&i&&s&&o&&c&&p&&f&&l){e.next=4;break}return e.abrupt("return",null);case 4:return e.next=6,(0,b.findOneUser)(i);case 6:return d=e.sent,e.next=9,(0,b.findByEmail)(s);case 9:if(m=e.sent,!d&&!m){e.next=12;break}return e.abrupt("return",null);case 12:return e.next=14,F(o);case 14:return g=e.sent,e.next=17,W();case 17:return y=e.sent,e.next=20,(0,b.createUser)(u,a,s,!1,y,i,g,c,p,f,l);case 20:return w=e.sent,e.next=23,L(w.email,y);case 23:return e.abrupt("return",w);case 24:case"end":return e.stop()}}),e)}))),function(e,r,n){return ne.apply(this,arguments)}),confirmCode:(re=m()(h().mark((function e(r,n,t){var u,a,i,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.User,u=r.username,a=r.code,u&&a){e.next=4;break}return e.abrupt("return",null);case 4:return e.next=6,(0,b.findOneUser)(u);case 6:if(i=e.sent){e.next=9;break}return e.abrupt("return",null);case 9:if(i.codeVerify!=a){e.next=16;break}return e.next=12,(0,b.confirmEmail)(u,!0);case 12:return s=e.sent,e.abrupt("return",s);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e)}))),function(e,r,n){return re.apply(this,arguments)}),confirmPassword:(ee=m()(h().mark((function e(r,n,t){var u,a,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.User,u=r.username,a=r.password,u&&a){e.next=4;break}return e.abrupt("return",null);case 4:return e.next=6,(0,b.findOneUser)(u);case 6:if(i=e.sent){e.next=9;break}return e.abrupt("return",null);case 9:return e.next=11,V(a,i.password);case 11:if(!e.sent){e.next=13;break}return e.abrupt("return",i);case 13:return e.abrupt("return",null);case 14:case"end":return e.stop()}}),e)}))),function(e,r,n){return ee.apply(this,arguments)}),confirmUser:($=m()(h().mark((function e(r,n,t){var u,a,i,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.User,u=r.username){e.next=4;break}return e.abrupt("return",null);case 4:return e.next=6,(0,b.findOneUser)(u);case 6:if(a=e.sent){e.next=9;break}return e.abrupt("return",null);case 9:return e.next=11,W();case 11:return i=e.sent,s=a.email,e.next=15,(0,b.updateUser)(u,{codeVerify:i});case 15:return e.next=17,L(s,i);case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}}),e)}))),function(e,r,n){return $.apply(this,arguments)}),changePassword:(X=m()(h().mark((function e(r,n,t){var u,a,i,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.User,u=r.username,a=r.password,u&&a){e.next=4;break}return e.abrupt("return",null);case 4:return e.next=6,(0,b.findOneUser)(u);case 6:if(e.sent){e.next=9;break}return e.abrupt("return",null);case 9:return e.next=11,F(a);case 11:return i=e.sent,e.next=14,(0,b.changePassword)(u,i);case 14:if(s=e.sent){e.next=17;break}return e.abrupt("return",null);case 17:return e.abrupt("return",s);case 18:case"end":return e.stop()}}),e)}))),function(e,r,n){return X.apply(this,arguments)}),updateUser:(K=m()(h().mark((function e(r,n,t){var u,a,i,s,o,c,p;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.User,u=r.oldUsername,a=r.newUsername,i=r.name,s=r.lastName,o=r.email,c={name:"",lastname:"",email:"",username:""},i&&(c.name=i),s&&(c.lastname=s),!o){e.next=12;break}return e.next=8,(0,b.findByEmail)(o);case 8:if(!e.sent){e.next=11;break}return e.abrupt("return",null);case 11:c.email=o;case 12:if(!a){e.next=17;break}if(p=(0,b.findOneUser)(a),a!=p.username){e.next=16;break}return e.abrupt("return",null);case 16:c.userName=a;case 17:if(""!=c.username||""!=c.name||""!=c.lastname||""!=c.email){e.next=19;break}return e.abrupt("return",null);case 19:return e.next=21,(0,b.updateUser)(u,c);case 21:return e.abrupt("return",e.sent);case 22:case"end":return e.stop()}}),e)}))),function(e,r,n){return K.apply(this,arguments)}),createEbook:(J=m()(h().mark((function e(r,n,t){var u,a,i,s,o,c,p,f,l,d,m,g,b,y,w,x,S,k,v,U,E,q,P;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Ebook,u=r.title,a=r.subTitle,i=r.path,s=r.content,o=r.pages,c=r.published,p=r.language,f=r.author,l=r.authorBio,d=r.copyReader,m=r.copyReaderBio,g=r.illustrator,b=r.illustratorBio,y=r.edition,w=r.gender,x=r.description,S=r.btnPayPal,k=r.legalDepo,v=r.isbn,U=r.editor,E=r.editorBio,q=r.price,e.next=4,Z(u,a,i,s,o,c,p,f,l,d,m,g,b,y,w,x,S,k,v,U,E,q);case 4:return P=e.sent,e.abrupt("return",P);case 6:case"end":return e.stop()}}),e)}))),function(e,r,n){return J.apply(this,arguments)}),ebookPayed:(Q=m()(h().mark((function e(r,n,t){var u,a,i,s,o,c;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.User,u=r.username,a=r.title,u&&a){e.next=4;break}return e.abrupt("return",null);case 4:return e.next=6,(0,b.findOneUser)(u);case 6:return i=e.sent,e.next=9,M(a);case 9:return s=e.sent,o={ebookAccess:s.title},e.next=13,(0,b.updateEbookFront)(i.username,o);case 13:return c=e.sent,e.abrupt("return",c);case 15:case"end":return e.stop()}}),e)}))),function(e,r,n){return Q.apply(this,arguments)}),updateEbookSelled:function(){var e=m()(h().mark((function e(r,n,t){var u,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.Ebook,u=r.title){e.next=4;break}return e.abrupt("return",null);case 4:return e.next=6,M(u);case 6:if(a=e.sent){e.next=9;break}return e.abrupt("return",null);case 9:return e.next=11,R(u,a.selled+1);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})));return function(r,n,t){return e.apply(this,arguments)}}()};var Q,J,K,X,$,ee,re,ne,te,ue,ae,ie,se,oe,ce=n(590),pe={timestamps:{currentTime:function(){return Math.floor(Date.now())}}},fe=(0,y.Schema)({title:{type:String,require:!0},path:{type:[String],default:[]}},pe);const le=(0,y.model)("ebookPdf",fe);var de=r()();n(334).config(),de.use(u()("dev")),de.use((0,e.json)()),de.use((0,e.urlencoded)({extended:!0})),de.use(i()()),de.use(o()()),de.use(p()()),n(201),de.use("/graphql",(0,f.graphqlHTTP)({schema:l,rootValue:H,context:{User:ce.Z,Ebook:S,EbookPages:le},graphiql:!0}));const me=de;me.set("port",process.env.PORT),me.listen(me.get("port"),(function(){console.log("Server run on port",me.get("port"))}))})()})();